This document describes how to build Spring bean container support for Apache James

1. Preparations

1.1 Fetch James Server from TRUNK from svn and build

svn co http://svn.apache.org/repos/asf/james/server/trunk
cd trunk
ant dist

1.2 Fetch Spring Integration module from svn

svn co http://svn.apache.org/repos/asf/james/server/sandbox/spring-integration

1.3 Add freshly generated James jars to spring-integration
(this step can be ommitted, once spring-deployment is moved to trunk)

cp trunk/stage/org.apache.james/jars/james-server-* spring-integration/stage/org.apache.james/jars/

2. Considering some configuration

if you are not root/Administrator on your machine or have a mail server already running on some privileged port,
it is recommended to change in file
    spring-integration/spring-deployment/src/main/config/beans-base-config.xml
line
                <!--<ref bean="exampleConfigurationInterceptor" />-->
into 
                <ref bean="exampleConfigurationInterceptor" />
this will start all services at non-privileged ports. This is for testing only, as it makes your server instance
more or less incompatible with the rest of the emailing universe.

3. Building and Running

cd spring-integration/spring-deployment
ant run

4. JMX

Enabling: Uncomment the JMX section in beans-base-config.xml
Connecting: The default connection URL defined in this file is 
  service:jmx:rmi://localhost/jndi/rmi://localhost:1099/jamesmailserver
You can use this URL on the command line under Java 1.5 (or newer) like this:
  jconsole service:jmx:rmi://localhost/jndi/rmi://localhost:1099/jamesmailserver
You will find the Processor/Mailet/Matcher tree under "Phoenix" and the other management beans under "beans". 

A. Updating configuration files

The configuration files are taken nearly unchanged from James module 'phoenix-depoyment'.
To update spring-deployment to latest from phoenix-deployment, copy files
  james-assembly.xml
  james-config.xml
  james-fetchmail.xml
  james-listmanager.xml
  james-liststores.xml
  james-xmtphandlerchain.xml
  mailboxManagerSqlResources.xml
  miResources.xml
  sqlResources.xml
from 
  trunk/phoenix-deployment/src/conf
to 
  spring-deployment/src/main/config/
