<?xml version="1.0"?>
<avalon>
    <blocks>
<!--   !!!!!!!!!! Begin copy and paste !!!!!!!!!!  -->
    
<!-- JAMES POP3 server Blocks -->

        <block class="org.apache.james.pop3server.POP3Server"
                serverName="James"
                implementedInterface=""
                help="This block impement a POP3 server. Il will look for mails
                    under [mailboxName].[username]">

            <port>110</port>
            <pop3handler>

                <servername>
<!-- ________________ FILL ME ________________ -->
<!-- Place your server name here. It is used for hello message.  -->
                </servername>

                <connectiontimeout help="After this time in milliseconds that no
                        command are received the connection will be closed">
                    120000 
                </connectiontimeout>
                <mailboxName help="The name of the public repository where mails
                        are stored">
                    localInbox 
                </mailboxName>
            </pop3handler>
        </block>

<!-- JAMES SMTP server Blocks -->

        <block class="org.apache.james.smtpserver.SMTPServer"
                serverName="James"
                implementedInterface=""
                help="This block implements a SMTP server. Incoming mails will be
                    delivered to the MailServer implementation">

            <port>25</port>
            <smtphandler>

                <servername>
<!-- ________________ FILL ME ________________ -->
<!-- Place your server name here. It is used for hello message.  -->
                </servername>

                <connectiontimeout help="After this time in milliseconds that no
                        command are received the connection will be closed">
                    120000 
                </connectiontimeout>
            </smtphandler>
        </block>

<!-- JAMES MailServer Implementation -->

        <block class="org.apache.james.james.James"
               serverName="James"
               implementedInterface="org.apache.avalon.blocks.MailServer">

                <servername>
<!-- ________________ FILL ME ________________ -->
<!-- Place your server name here. It is used for hello message.  -->
                </servername>

            <spoolRepository> 
<!-- ________________ FILL ME ________________ -->
<!-- Place here the path where incoming mail are temporaly stored before 
    beeing processed. (ex. file://c:/james/spool/) -->
            </spoolRepository>

            <spoolmanagerthreads help="The number of threads that spool and 
                    process messages from spoolRepository.">
                1
            </spoolmanagerthreads>
            <spoolmanager>
                <localhost> localhost </localhost>
                <localhost> maggie </localhost>
                <localhost> maggie.galaxus </localhost>

<!-- ________________ ATTENTION ________________ -->
<!-- Configure your mail Servlet processing pipe here. Take commented lines as 
    example (commented lines are not necessary). -->

                <servlets rootpath="org.apache.james.james.servlet.">
    <!-- EXAMPLE
                    <servlet match="All" class="ToRepository">
                        <repository> file://c:/archivio/store/james/maillog/ </repository>
                        <passThrought> true </passThrought>
                    </servlet>
                    <servlet match="RecipientIs=root@localhost,admin@localhost | HostIs=systemy.it" class="Forward">
                        <forwardto> scoobie@localhost </forwardto>
                    </servlet>
    EXAMPLE -->

<!-- These servlet act as system servlet and provides local deliver -->

<!-- ________________ FILL ME ________________ -->
<!--  Fill the HostIs parameter to comma separated list of your server names 
without spaces (ex. HostIs=maggie.galaxus,localhost) + + + + + + -->
                    <servlet match="HostIs= " class="LocalDelivery">

                        <repository> localInbox </repository>
                    </servlet>

<!-- These servlet act as system servlet and provides remote deliver -->
                    <servlet match="All" class="RemoteDelivery">

                        <outgoingmailserver>  
<!-- ________________ FILL ME ________________ -->
<!--  Fill the outgoingmailserver with your default mail server (ex. mail.tin.it) -->
                        </outgoingmailserver>

                        <repository>  
<!-- ________________ FILL ME ________________ -->
<!--  Fill the repository path where to store temoporaly underiverable messages 
    (ex. file://c:/archivio/store/james/delayed/) -->
                        </repository>

                        <delayTime>20000</delayTime>
                        <maxRetyes>5</maxRetyes>
                    </servlet>

<!-- The last servlet in the pipe is the one managing errors -->
                    <servlet match="All" class="ToRepository">

                        <repository>  
<!-- ________________ FILL ME ________________ -->
<!--  Fill the repository path where error are stored 
    (ex. (file://c:/archivio/store/james/errors/) -->
                        </repository>

                        <passThrought> false </passThrought>
                    </servlet>
                </servlets>
            </spoolmanager>
        </block>

<!-- Block to manage JAMES users accounts -->

        <block class="org.apache.james.remotemanager.RemoteManager"
               serverName="James"
               implementedInterface="">
            <port>4555</port>
            <AdministratorAccounts>
                <Account login="root" password="root"/>
            </AdministratorAccounts>
                <connectiontimeout help="After this time in milliseconds that no
                        command are received the connection will be closed">
                    60000 
                </connectiontimeout>
        </block>

<!--  !!!!!!!!!! End copy and paste !!!!!!!!!!  -->

<!-- ________________ ATTENTION ________________ -->

<!--  Add these lines to the Logger implementation under the avalon.conf.xml.
    Copy each <channel> element under <channels> element in avalon.conf.xml and
    each <writer> under <logwriters>. If you want you can change logfile 
    destination. -->
    
        <block class="[...]"
               serverName="all"
               implementedInterface="org.apache.avalon.blocks.Logger">
            <channels>
                <channel name="RemoteManager"  loglevel="DEBUG"  logwriter="admin"/>
                <channel name="POP3Server"     loglevel="DEBUG"  logwriter="popfile"/>
                <channel name="SMTPServer"     loglevel="DEBUG"  logwriter="smtpfile"/>
                <channel name="JAMES"          loglevel="DEBUG"  logwriter="jamesfile"/>
                <channel name="Mail Servlet"   loglevel="DEBUG"  logwriter="jamesfile"/>
            </channels>
            <logwriters>
                <writer name="jamesfile" class="org.apache.avalon.blocks.omero.FileWriter">
                    <destination>
                        file://./logs/jamesinfo.log
                    </destination>
                    <buffersize>2048</buffersize>
                    <sleep>5000</sleep>
                </writer>
                <writer name="smtpfile" class="org.apache.avalon.blocks.omero.FileWriter">
                    <destination>
                        file://./logs/smtpinfo.log
                    </destination>
                    <buffersize>2048</buffersize>
                    <sleep>5000</sleep>
                </writer>
                <writer name="popfile" class="org.apache.avalon.blocks.omero.FileWriter">
                    <destination>
                        file://./logs/popinfo.log
                    </destination>
                    <buffersize>2048</buffersize>
                    <sleep>5000</sleep>
                </writer>
                <writer name="admin" class="org.apache.avalon.blocks.omero.FileWriter">
                    <destination>
                        file://./logs/admininfo.log
                    </destination>
                    <buffersize>2048</buffersize>
                    <sleep>5000</sleep>
                </writer>
            </logwriters>
        </block>

<!-- ________________ ATTENTION ________________ -->
                
<!--  Add these lines to the Store implementation under the avalon.conf.xml.
    Copy <repository type=...> under <repositoriesDefinition> and 
    <repository name=... under <publicrepositories> -->
        <block class="[...]"
               serverName="all"
               implementedInterface="org.apache.avalon.blocks.Store">
            <repositoriesDefinition>
                <repository type="MESSAGE_CONTAINER" model="SYNCHRONOUS, ASYNCHRONOUS"
                    destination="file://"
                    class="org.apache.james.MessageContainerRepository"/>
            </repositoriesDefinition>
            <publicrepositories>

                <repository name="localInbox" type="MESSAGE_CONTAINER" model="SYNCHRONOUS">
<!-- ________________ FILL ME ________________ -->
<!-- Fill element with path where processed message are stored. This public 
    Repository is shared amongst the MailServer and POP3Server.
    (ex. file://c:/archivio/store/james/localinbox/) -->
                </repository>

                <repository name="MailUsers" type="OBJECT" model="SYNCHRONOUS">
<!-- ________________ FILL ME ________________ -->
<!-- Fill element with path where users data are stored.
    (ex. file://c:/archivio/store/james/users/) -->
                </repository>

            </publicrepositories>
        </block>
    </blocks>
</avalon>